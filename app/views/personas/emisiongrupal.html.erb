<style type="text/css">
blockquote {
  padding: 3px 10px;
  border: Black 5px solid;
  border-radius: 20px;
}
</style>

<style>

@media print {
    /*@page {
        size: letter landscape
    }
*/
    .left-sidebar{
      display: none;
    }

    .topbar{
      display: none;
    }

}

</style>

<div class="form body">
<div class="row">
  <div class="col-md-24">
    <div class="card card-outline-info">
      <div class="card-block">
        <%= form_tag("/persona/guarda_emisiongrupal", method: "POST") do %>
        <div class="form-body">

          <!--primera fila-->
        <div class="row">

          <div class="col-md-4">
            <div class="form-group">
                <label class="control-label">
                <h3><b>Fecha</b></h3></label>
                <%= date_field_tag("persona[fecha_emi_certf]", nil,class: 'form-control')%>
              </div>
            </div>
       </div>
            
          <!-- fin primera fila -->

          <!-- 2da fila -->
          <div class="row">

           <!-- 1ra columna -->
           <div class="col-md-3">
              <div class="form-group">
                <label class="control-label"><h3>No. Reg.</h3></label>
                <%= text_field "persona[no_reg]",
                    {
                      :class => 'form-control',
                      required: 'required',
                    }
                %>
              </div>
            </div>
            <!--fin 1ra columna-->
        
             <!-- 2da columna -->
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">
                  <h3>No. Correlat.</h3></label>
                    <%= text_field "persona[correlt_certf]",
                      {
                          :class => 'form-control',
                          required: 'required',
                       } %>
              </div>
            </div>
          <!--fin 2da columna-->
            
         </div>
         <!-- fin 2da fila -->


         <!-- busca ultima impresion su id -->
          <div class="row">
            <div class="col-md-6">
            ultima impresion 
            <%= @ultima_impresion  %>
            id impresion 
            <%= @consulta_impresion.id  %>
            <input type="text" id="cod_impre" name="id_imp" value='<%= @consulta_impresion.id  %>'>
            <div class='row'>
              <table id="users-datatable" class="table table-bordered" data-source="<%= emision_grupal_path(format: :json) %>">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>CI</th>
                    <th>Nombre</th>
                    <th>Seleccionar</th>
                  </tr>
                </thead>
                <tbody>
                </tbody>
              </table>
            </div>
          </div>

            <div class="col-md-6">
              <div id="los_seleccionados">
                aqui los seleccionados    
                        
              </div>
            </div>
          </div>
        <!-- fin de la busqueda impresion-id -->  

        </div>
      </div>
    </div>
  </div>
         
 <!--/span-->


          <div class="form-actions">
            <button type="submit" class="btn btn-success"><i class="fa fa-check"></i> Save</button>
            <button type="button" class="btn btn-inverse">Cancel</button>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

<% # end %>
<script>
$(document).ready(function() {
  $('#users-datatable').dataTable({
    "processing": true,
    "serverSide": true,
    "ajax": $('#users-datatable').data('source'),
    "pagingType": "full_numbers",
    "columns": [
      {"data": "id"},
      {"data": "ci"},
      {"data": "nombre"},
      {"data": "acciones"}
    ]
    // pagingType is optional, if you want full pagination controls.
    // Check dataTables documentation to learn more about
    // available options.
  });
});
</script>

<script>
  $("#persona_ci").keyup(function () {
    var campo_texto = $("#persona_ci").val();
    var cantidad_letras = campo_texto.length;
    // console.log('var: '+campo_texto);
    if(cantidad_letras > 3){
      Rails.ajax({
        type: 'GET',
        url: '/persona/bg_ci_ajax/'+campo_texto,
        data: {"dato_crt": campo_texto},
        success: function(data, textStatus, jqXHR){
          $("#emi_persona").load('/persona/bg_ci_ajax/'+campo_texto);
        }
      });
    }
  });
</script>


<script>
  function guarda_persona_js(id_persona){
      
      // js_ul_imp++;
      // capturamos el dato del campo de texto
      var cod_impresion = $('#cod_impre').val();
      console.log("cod_impresion "+cod_impresion);
      //console.log('var: '+campo_texto);
      console.log('variable es '+id_persona);

      $.ajax({
        type: 'GET',
        url: '/persona/guarda_grupal/'+id_persona+'/'+cod_impresion,
        data: {"dato_crt": cod_impresion},
        success: function(data, textStatus, jqXHR){
          // alert('entro');
          $("#los_seleccionados").load('/persona/muestra_grupal/'+cod_impresion);
        }
      });


    }
</script>
